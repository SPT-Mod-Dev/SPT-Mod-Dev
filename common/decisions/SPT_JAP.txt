
# SPT_JAP_conf_ = {
# 	cost = 50
# 	fire_only_once = no

# 	icon = GFX_decision_revolt

# 	available = {
		
# 	}
# 	visible = {

# 	}

# 	#days_remove = 2
	
# 	# modifier = {
# 	# 	#fake modifiers using tooltips combined with hidden ideas, makes it easier to add and remove the effects
# 	# }

# 	complete_effect = {
# 		#hidden_effect = {
# 		#	remove_ideas = SPT_JAP_conference_debug_idea
# 		#}
# 		#custom_effect_tooltip = SPT_JAP_conference_debug_remove_buff_tt
# 	}
# }

SPT_JAP_eco_pressure = {
	SPT_JAP_eco_debug = {

		cost = 10
		fire_only_once = no

		icon = GFX_decision_revolt

		available = {
		
		}
		visible = {
			is_debug = yes
			is_ai = no
		}

		#days_remove = 2
	
		# modifier = {
			# 	#fake modifiers using tooltips combined with hidden ideas, makes it easier to add and remove the effects
		# }

		complete_effect = {
			#hidden_effect = {
			#	remove_ideas = SPT_JAP_conference_debug_idea
			#}
			#custom_effect_tooltip = SPT_JAP_conference_debug_remove_buff_tt
		}
	}
	SPT_JAP_eco_pressure_up_debug = {
		cost = 0
		fire_only_once = no

		icon = GFX_decision_revolt

		available = {
		
		}
		visible = {
			is_debug = yes
			is_ai = no
		}

		#days_remove = 2
	
		# modifier = {
			# 	#fake modifiers using tooltips combined with hidden ideas, makes it easier to add and remove the effects
		# }

		complete_effect = {
			add_to_variable = {
				SPT_JAP_eco_pressure_consumer_goods_expected_value = 0.01
			}
		}
	}
	SPT_JAP_eco_pressure_down_debug = {
		cost = 0
		fire_only_once = no

		icon = GFX_decision_revolt

		available = {
		
		}
		visible = {
			is_debug = yes
			is_ai = no
		}

		#days_remove = 2
	
		# modifier = {
			# 	#fake modifiers using tooltips combined with hidden ideas, makes it easier to add and remove the effects
		# }

		complete_effect = {
			add_to_variable = {
				SPT_JAP_eco_pressure_consumer_goods_expected_value = -0.01
			}
		}
	}
	SPT_JAP_eco_pressure_reset_debug = {
		cost = 0
		fire_only_once = no

		icon = GFX_decision_revolt

		available = {
		
		}
		visible = {
			is_debug = yes
			is_ai = no
		}

		#days_remove = 2
	
		# modifier = {
			# 	#fake modifiers using tooltips combined with hidden ideas, makes it easier to add and remove the effects
		# }

		complete_effect = {
			set_variable = {
				SPT_JAP_eco_pressure_consumer_goods_expected_value = 0
			}
		}
	}


	#This is the main event that takes care of the timed increases in cg from the Eco Bubble Mechanic
	SPT_JAP_eco_pressure_timed_increase = { 
		allowed = {
			tag = JAP 
		}

		icon = GFX_decision_gre_paying_ifc_debt

		days_mission_timeout = 120
		is_good = yes
		fire_only_once = yes

		cancel_trigger = {
			# NOT = {
			# 	has_idea = SPT_USA_recession_looming
			# }
		}
		
		activation = {
			has_completed_focus = SPT_JAP_planned_eco
		}
		available = {
			always = no
		}

		visible = {
			has_completed_focus = SPT_JAP_planned_eco
		}
		
		cancel_effect = {
		}

		timeout_effect = {
			# so, just to be clear here because it can be a bit weird and
			# there's some technical debt that i can't be arsed to deal with,
			# the way this works is that there's a variable called spt_jap_cg_increase_tracker
			# that determines how much the cg increase will be. This variable gets
			# set up in the focus SPT_JAP_planned_eco, which i know is a bit odd
			# and not exactly great coding, but it is what it is. If you wanna
			# adjust how much this increase is at base, then you just gotta go
			# in that focus and move the needle a bit. 
			# Other info that might be useful is that this stupid value can't go
			# negative (fuck you paradox) and if you want an example of how to change
			# it on the fly, the focus SPT_JAP_rapid_dev is a good one to look at.
			# Sincerely, if it wasn't my obsession to make this nation both more fun and
			# more miserable to play, i wouldn't ever recommend going down this route
			# for making a mechanic, this whole thing is held together with duct tape and spit.
			add_to_variable = {
				var = SPT_JAP_eco_pressure_consumer_goods_expected_value
				value = spt_jap_cg_increase_tracker
				tooltip = SPT_JAP_cg_expected_tt
			}
			hidden_effect = {
				activate_mission = SPT_JAP_eco_pressure_timed_increase 
			}

		}

		ai_will_do = {
		}
	}

	SPT_JAP_manchu_grain = {
		allowed = {
			original_tag = JAP
		}
		ai_will_do = {
			factor = 200
		}
		available = {
			has_completed_focus = SPT_JAP_manchurian_project
			OR = {
				MAN = {exists = yes}
				any_controlled_state = {is_core_of = MAN}
			}
			custom_trigger_tooltip = {
				tooltip = SPT_JAP_cg_threshold_3_or_higher_tt
				check_variable = {
					var = SPT_JAP_eco_pressure_consumer_goods_expected_value
					value = 0.03
					compare = greater_than_or_equals
				}
			}

		}
		fire_only_once = yes
		#days_remove = 70
		cost = 25
		# modifier = {
		# 	civilian_factory_use = 2
		# }
		icon = GFX_decision_POL_looming_peasants_strike
		
		complete_effect = {
			custom_effect_tooltip = SPT_JAP_eco_pressure_modify_header_tt
			add_to_variable = {
				var = SPT_JAP_eco_pressure_consumer_goods_expected_value
				value = -0.03
				tooltip = SPT_JAP_cg_expected_tt
			}
			custom_effect_tooltip = SPT_JAP_whitespace_tt
			MAN = {
				add_timed_idea = {
					idea = SPT_JAP_exploit_manchu_grain
					days = 180
				}
			}
		}
	}

	SPT_JAP_korean_grain = {
		allowed = {
			original_tag = JAP
		}
		ai_will_do = {
			factor = 200
		}
		available = {
			has_completed_focus = SPT_JAP_korean_project
			OR = {
				KOR = {exists = yes}
				any_controlled_state = {is_core_of = KOR}
			}
			custom_trigger_tooltip = {
				tooltip = SPT_JAP_cg_threshold_3_or_higher_tt
				check_variable = {
					var = SPT_JAP_eco_pressure_consumer_goods_expected_value
					value = 0.03
					compare = greater_than_or_equals
				}
			}

		}
		fire_only_once = yes
		days_remove = 70
		cost = 25
		modifier = {
			civilian_factory_use = 2
		}
		icon = GFX_decision_POL_looming_peasants_strike
		remove_effect = {
			custom_effect_tooltip = SPT_JAP_eco_pressure_modify_header_tt
			add_to_variable = {
				var = SPT_JAP_eco_pressure_consumer_goods_expected_value
				value = -0.03
				tooltip = SPT_JAP_cg_expected_tt
			}
		}
	}
}

SPT_JAP_korea_dev = {

	SPT_JAP_korea_light_ind = {
		allowed = {
			original_tag = JAP
		}
		ai_will_do = {
			factor = 200
		}
		available = {
			has_completed_focus = SPT_JAP_korean_project
			OR = {
				KOR = {exists = yes}
				any_controlled_state = {is_core_of = KOR}
			}
		}
		fire_only_once = yes
		days_remove = 70
		cost = 25
		modifier = {
			civilian_factory_use = 3
		}
		icon = GFX_decision_generic_factory
		remove_effect = {
			random_state = {
				limit = {
					is_core_of = KOR
					OR = {
						is_fully_controlled_by = JAP
						is_fully_controlled_by = KOR
					}
				}
				add_extra_state_shared_building_slots = 3
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			random_state = {
				limit = {
					is_core_of = KOR
					OR = {
						is_fully_controlled_by = JAP
						is_fully_controlled_by = KOR
					}
				}
				add_extra_state_shared_building_slots = 3
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
	}
	SPT_JAP_korea_heavy_ind = {
		allowed = {
			original_tag = JAP
		}
		ai_will_do = {
			factor = 200
		}
		available = {
			has_completed_focus = SPT_JAP_korean_project
			OR = {
				KOR = {exists = yes}
				any_controlled_state = {is_core_of = KOR}
			}
		}
		fire_only_once = yes
		days_remove = 70
		cost = 25
		modifier = {
			civilian_factory_use = 3
		}
		icon = GFX_decision_generic_industry
		remove_effect = {
			random_state = {
				limit = {
					is_core_of = KOR
					OR = {
						is_fully_controlled_by = JAP
						is_fully_controlled_by = KOR
					}
				}
				add_extra_state_shared_building_slots = 3
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
			random_state = {
				limit = {
					is_core_of = KOR
					OR = {
						is_fully_controlled_by = JAP
						is_fully_controlled_by = KOR
					}
				}
				add_extra_state_shared_building_slots = 3
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
		}
	}
	SPT_JAP_japanese_settlement = {
		allowed = {
			original_tag = JAP
		}
		ai_will_do = {
			factor = 200
		}
		available = {
			has_completed_focus = SPT_JAP_korean_project
			OR = {
				KOR = {exists = yes}
				any_controlled_state = {is_core_of = KOR}
			}
		}
		fire_only_once = yes
		days_remove = 70
		cost = 25
		modifier = {
			civilian_factory_use = 3
		}
		icon = GFX_decision_generic_train
		remove_effect = {
			hidden_effect = {
				add_ideas = SPT_JAP_settled_korea
			}
			every_owned_state = {
				limit = {
					is_core_of = JAP
					NOT = {
						is_core_of = KOR
					}
				}
				add_manpower = -5000
			}
			every_owned_state = {
				limit = {
					is_core_of = KOR
				}
				add_manpower = 35000
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
				add_dynamic_modifier = {
					modifier = SPT_JAP_korea_industry_help
					days = 250
				}
			}
		}
	}
}
SPT_JAP_take_away_colonial_factories = {
	set_variable = {
		var = max_factories_to_take
		value = 50
	}
	set_variable = {
		var = taken_factories_count
		value = 0
	}
	set_variable = {
		var = at_least_one_taken
		value = 0
	}
	set_variable = {
		var = factories_to_add
		value = 0
	}

	while_loop_effect = {

		limit = {
			any_controlled_state = {
				NOT = {
					is_core_of = JAP
				}
				industrial_complex > 0
			}

			any_controlled_state = {
				is_core_of = JAP
				free_building_slots = {
					building = industrial_complex
					size > 0
					include_locked = yes
				}
			}
		}


		random_owned_controlled_state = {
			limit = {
				NOT = {
					is_core_of = JAP
				}
				industrial_complex > 0
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
			add_resistance = 15
		}

		random_owned_controlled_state = {
			limit = {
				is_core_of = JAP
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
			random_list = {
				2 = {
					damage_building = { type = industrial_complex damage = 0.33 }
				}
				2 = {
					#nothing happens
				}
			}
		}
	}

}

SPT_JAP_add_factories_with_counter_test = {
	set_variable = {
		var = at_least_one_taken_debug
		value = 50
	}
	set_variable = {
		var = factories_to_add_debug
		value = at_least_one_taken_debug
	}
	set_variable = {
		var = factories_taken
		value = 0
	}

	while_loop_effect = {
		limit = {
			check_variable = {
				var = factories_to_add_debug
				value = 0
				compare = greater_than
			}
		}
		random_owned_controlled_state = {
			limit = {
				is_core_of = JAP
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
		subtract_from_variable = {
			var = factories_to_add_debug
			value = 1
		}
		add_to_variable = {
			var = factories_taken_debug
			value = 1
		}
	}
}